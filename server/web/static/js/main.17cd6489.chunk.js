(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{166:function(e,a,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},167:function(e,a,n){},286:function(e,a,n){e.exports=n(331)},331:function(e,a,n){"use strict";n.r(a);var t=n(0),r=n.n(t),l=n(27),i=n.n(l),c=n(9),o=n(15),u=(n(166),n(167),n(380)),m=n(16),d=n(395),s=n(398),b=n(252),f=n(404),g=n(385),p=n(391),E=n(199),v=n(389),h=n(390),O=n(334),j=n(259),y=n.n(j),x=n(367),C=n(368);n(366);Object(x.a)((function(e){return{footer:{backgroundColor:e.palette.background.paper,padding:e.spacing(6,0)}}}));var k=n(388),S=n(393),$=n(26),w=n(30),I=n(148),P=n(3),N=n(392),T=n(370),R=n(374),D=n(373),B=n(369),W=n(371),F=n(372),L=n(263),V=n(400);function A(){var e=Object(o.a)(["\nmutation SetChiefId($id: Int!) {\n  setChiefId(id: $id)\n}\n"]);return A=function(){return e},e}function z(){var e=Object(o.a)(["\n   mutation SetDieStatus($id: Int!) {\n    setDieStatus(id: $id)\n  }\n"]);return z=function(){return e},e}var U=Object(x.a)((function(e){return{margin:{margin:e.spacing(1)},table:{minWidth:550},title:{flexGrow:1},menuButton:{marginRight:e.spacing(2)}}})),G=Object(m.a)(z()),q=Object(m.a)(A());function K(e){var a=U(),n=Object(f.a)(G),t=Object(c.a)(n,1)[0],l=Object(f.a)(q),i=Object(c.a)(l,1)[0];return r.a.createElement(B.a,{component:L.a},r.a.createElement(T.a,{className:a.table,"aria-label":"simple table",size:"small"},r.a.createElement(W.a,null,r.a.createElement(F.a,null,r.a.createElement(D.a,null,"\u8b66\u9577"),r.a.createElement(D.a,null,"\u6b7b\u4ea1"),r.a.createElement(D.a,null,"ID"),r.a.createElement(D.a,{align:"left"},"\u73a9\u5bb6"),r.a.createElement(D.a,{align:"right"},"\u89d2\u8272"),r.a.createElement(D.a,{align:"right"},"\u6295\u7968"),r.a.createElement(D.a,{align:"right"},"\u4e0a\u7dda"))),r.a.createElement(R.a,null,e.data.map((function(a){return r.a.createElement(F.a,{key:a.id},r.a.createElement(D.a,null,r.a.createElement(V.a,{onChange:function(e){i({variables:{id:a.id}})},checked:a.id===e.chiefId,color:"primary",inputProps:{"aria-label":"secondary checkbox"}})),r.a.createElement(D.a,null,a.id?r.a.createElement(V.a,{onChange:function(e){t({variables:{id:a.id}})},checked:a.isDie,color:"primary",inputProps:{"aria-label":"secondary checkbox"}}):null),r.a.createElement(D.a,{component:"th",scope:"row"},a.id),r.a.createElement(D.a,{align:"right"},a.name),r.a.createElement(D.a,{align:"right"},a.roleName),r.a.createElement(D.a,{align:"right"},a.votedNumber),r.a.createElement(D.a,{align:"right"},r.a.createElement("span",{style:{color:a.isEmpty?"gray":a.isVoteFinish?"lightgreen":"orange",transition:"all .3s ease",fontSize:"24px",marginRight:"10px"}},"\u25cf")))})))))}function M(){var e=Object(o.a)(["\n  {\n    roles {\n      id\n      name\n      number\n    }\n    players {\n      id\n      name\n      roleName\n      isEmpty\n    }\n  }\n"]);return M=function(){return e},e}Object(m.a)(M());var H=Object(x.a)((function(e){return{margin:{margin:e.spacing(1)},table:{minWidth:450},title:{flexGrow:1},menuButton:{marginRight:e.spacing(2)}}}));function J(e){var a=H();console.log(e.data);var n=function(e){var a=0,n=[];return e.forEach((function(e){var t=e.number;t&&(a+=t,n.push(e))})),{total:a,data:n}}(e.data),t=n.total,l=n.data;return r.a.createElement(B.a,{component:L.a},r.a.createElement(T.a,{className:a.table,"aria-label":"simple table",size:"small"},r.a.createElement(W.a,null,r.a.createElement(F.a,null,r.a.createElement(D.a,null,"\u89d2\u8272"),r.a.createElement(D.a,{align:"right"},"\u4eba\u6578"))),r.a.createElement(R.a,null,l.map((function(e){return r.a.createElement(r.a.Fragment,{key:e.name},r.a.createElement(F.a,{key:e.name},r.a.createElement(D.a,{component:"th",scope:"row"},e.name),r.a.createElement(D.a,{align:"right"},e.number)),e.players?r.a.createElement(F.a,{align:"left"},e.players.map((function(e,a){return r.a.createElement("div",{style:{fontSize:22,marginLeft:45},key:a},"".concat(e.id," : ").concat(e.name))}))):null)})),r.a.createElement(F.a,null,r.a.createElement(D.a,{align:"right"},"\u7e3d\u4eba\u6578"),r.a.createElement(D.a,{align:"right"},t)))))}function Q(e){return r.a.createElement(J,{data:e.data})}var Y=n(396),_=n(379),X=n(13),Z=n(375),ee=n(377),ae=n(65),ne=n.n(ae),te=n(249),re=n.n(te),le=n(248),ie=n.n(le),ce=n(394),oe=n(73),ue=n.n(oe);function me(){var e=Object(o.a)(["\n  {\n    roles {\n      id\n      name\n      \n    }\n    \n  }\n"]);return me=function(){return e},e}var de=Object(m.a)(me()),se=Object(x.a)((function(e){return{margin:{margin:e.spacing(1)},table:{minWidth:250},title:{flexGrow:1},menuButton:{marginRight:e.spacing(2)}}}));function be(e){var a,n=se(),t=r.a.useState(-1),l=Object(c.a)(t,2),i=l[0],o=l[1],u=r.a.useState(0),m=Object(c.a)(u,2),d=m[0],s=m[1],b=Object(Z.a)(de),f=b.loading,g=(b.error,b.data);return f?r.a.createElement("div",null,"Loading"):(console.log(g),r.a.createElement("div",{style:{display:"flex",justifyContent:"center"}},r.a.createElement(ce.a,{id:"combo-box-demo",options:g.roles.filter((function(e){return e.id>0})),getOptionLabel:function(e){return e.name},style:{width:300},onChange:function(e,a){o(a.id)},renderInput:function(e){return r.a.createElement(N.a,Object.assign({},e,{label:"\u89d2\u8272",variant:"outlined",margin:"dense"}))}}),r.a.createElement(N.a,{id:"standard-basic",label:"\u4eba\u6578",variant:"outlined",className:n.margin,margin:"dense",type:"number",value:d,onChange:function(e){return s(e.target.value)}}),r.a.createElement("div",{style:{marginTop:5}},r.a.createElement(ee.a,(a={size:"medium",color:"secondary","aria-label":"add"},Object(X.a)(a,"size","small"),Object(X.a)(a,"onClick",(function(){e.updateRoleNumber({id:i,number:parseInt(d)})})),a),r.a.createElement(ue.a,null)))))}var fe=n(401),ge=n(402),pe="card",Ee={border:"1px dashed gray",padding:"0.5rem 1rem",marginBottom:".5rem",backgroundColor:"white",cursor:"move"},ve=function(e){var a=e.id,n=e.text,l=e.index,i=e.moveCard,o=Object(t.useRef)(null),u=Object(fe.a)({accept:pe,hover:function(e,a){if(o.current){var n=e.index,t=l;if(n!==t){var r=o.current.getBoundingClientRect(),c=(r.bottom-r.top)/2,u=a.getClientOffset().y-r.top;n<t&&u<c||n>t&&u>c||(i(n,t),e.index=t)}}}}),m=Object(c.a)(u,2)[1],d=Object(ge.a)({item:{type:pe,id:a,index:l},collect:function(e){return{isDragging:e.isDragging()}}}),s=Object(c.a)(d,2),b=s[0].isDragging?0:1;return(0,s[1])(m(o)),r.a.createElement("div",{ref:o,style:Object(I.a)({},Ee,{opacity:b})},n)},he=n(247),Oe=n.n(he),je={width:400},ye=function(e){var a=Object(t.useState)(Object(w.a)(e.data)),n=Object(c.a)(a,2),l=n[0],i=n[1],o=Object(t.useCallback)((function(a,n){var t=l[a],r=Oe()(l,{$splice:[[a,1],[n,0,t]]});i(r),e.onUpdate(r)}),[l]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:je},l.map((function(e,a){return function(e,a){return r.a.createElement(ve,{key:e.id,index:a,id:e.id,text:e.text,moveCard:o})}(e,a)}))))},xe=n(378),Ce=n(260);function ke(){var e=Object(o.a)(["\n  mutation UpdateRolePriority($name: String!, $ids: [Int]!) {\n    updateTemplateRolePriority(name: $name, ids: $ids)\n  }\n"]);return ke=function(){return e},e}function Se(){var e=Object(o.a)(["\n  mutation UpdateRule($name: String!, $description: String!) {\n    updateTemplateDescription(name: $name, description: $description)\n  }\n"]);return Se=function(){return e},e}function $e(){var e=Object(o.a)(["\n  mutation UpdateTempl($roleId: Int!, $number: Int!, $name: String!) {\n    updateTemplateRole(name: $name, number: $number, roleId: $roleId)\n  }\n"]);return $e=function(){return e},e}function we(){var e=Object(o.a)(["\n  query GetTemplate($name: String!) {\n    template(name: $name) {\n      roles {\n        name\n        number\n        id\n      }\n      description\n    }\n  }\n"]);return we=function(){return e},e}var Ie=Object(m.a)(we()),Pe=Object(m.a)($e()),Ne=Object(m.a)(Se()),Te=Object(m.a)(ke());function Re(e){var a=e.children,n=e.value,t=e.index,l=Object(P.a)(e,["children","value","index"]);return r.a.createElement("div",Object.assign({role:"tabpanel",hidden:n!==t,id:"full-width-tabpanel-".concat(t),"aria-labelledby":"full-width-tab-".concat(t)},l),n===t&&r.a.createElement(S.a,{p:3},a))}var De=function(e){var a=[];return e.forEach((function(e){var n=e.name,t=e.id;a.push({id:t,text:n})})),a};function Be(e){var a=e.name,n=r.a.useState([]),t=Object(c.a)(n,2),l=t[0],i=t[1],o=r.a.useState([]),u=Object(c.a)(o,2),m=u[0],d=u[1],s=r.a.useState(!1),b=Object(c.a)(s,2),g=(b[0],b[1],Object(Z.a)(Ie,{variables:{name:a},onCompleted:function(e){console.log("complete",e);var a=De(e.template.roles);i(a.map((function(e){return e.id}))),d(a.map((function(e){return e.id})))}})),p=g.loading,E=(g.error,g.data),v=g.refetch,h=Object(f.a)(Te,{onCompleted:function(){v()}}),j=Object(c.a)(h,2),y=j[0],x=j[1];if(p||x.loading)return r.a.createElement("div",null,"Loading");console.log(E,m,l);var C=De(E.template.roles);return r.a.createElement(xe.a,{backend:Ce.a},r.a.createElement(O.a,{"aria-label":"delete",onClick:function(){y({variables:{name:a,ids:l}})},color:m.toString()===l.toString()?"primary":"secondary"},r.a.createElement(ue.a,null)),r.a.createElement(ye,{data:C,onUpdate:function(e){console.log("update view"),i(e.map((function(e){return e.id})))}}))}function We(e){var a=e.name,n=e.data,t=Object(f.a)(Pe),l=Object(c.a)(t,1)[0];return r.a.useEffect((function(){return console.log("mount"+a),function(){console.log("umount"+a)}}),[]),r.a.createElement("div",null,r.a.createElement(E.a,{variant:"h2",gutterBottom:!0},a),r.a.createElement(be,{updateRoleNumber:function(e){var n=e.id,t=e.number;console.log(n,a),l({variables:{roleId:n,name:a,number:t}})}}),r.a.createElement(Q,{data:n}))}function Fe(e){var a=r.a.useState(e.value),n=Object(c.a)(a,2),t=n[0],l=n[1];return r.a.createElement("div",null,r.a.createElement(O.a,{"aria-label":"delete",onClick:function(){e.updateRule({variables:{description:t,name:e.name}})},color:t===e.value?"primary":"secondary"},r.a.createElement(ue.a,null)),r.a.createElement(N.a,{id:"outlined-multiline-static",multiline:!0,rows:4,fullWidth:!0,value:t,variant:"outlined",onChange:function(e){return l(e.target.value)}}))}function Le(e){var a=e.name,n=Object(Z.a)(Ie,{variables:{name:a}}),t=n.loading,l=(n.error,n.data),i=n.refetch,o=Object(f.a)(Ne,{onCompleted:function(){i()}}),u=Object(c.a)(o,2),m=u[0];u[1];return t?r.a.createElement("div",null,"Loading"):r.a.createElement(Fe,{value:l.template.description,updateRule:m,name:a})}function Ve(e){var a=e.name,n=e.data,t=r.a.useState(0),l=Object(c.a)(t,2),i=l[0],o=l[1];return console.log(a,n),r.a.createElement(L.a,{square:!0},r.a.createElement(Y.a,{value:i,indicatorColor:"primary",textColor:"primary",onChange:function(e,a){o(a)},"aria-label":"disabled tabs example"},r.a.createElement(_.a,{label:"\u89d2\u8272"}),r.a.createElement(_.a,{label:"\u898f\u5247"}),r.a.createElement(_.a,{label:"\u9ed1\u591c\u9806\u5e8f"})),r.a.createElement(Re,{value:i,index:0},r.a.createElement(We,{name:a,data:n})),r.a.createElement(Re,{value:i,index:1},r.a.createElement(Le,{name:a})),r.a.createElement(Re,{value:i,index:2},r.a.createElement(Be,{name:a})))}function Ae(){var e=Object(o.a)(["\n  mutation EnableTemplate($name: String!) {\n    enableTemplate(name: $name)\n  }\n"]);return Ae=function(){return e},e}function ze(){var e=Object(o.a)(["\n  mutation DeleteTemplate($name: String!) {\n    deleteTemplate(name: $name)\n  }\n"]);return ze=function(){return e},e}function Ue(){var e=Object(o.a)(["\n  mutation addTemplate($name: String!) {\n    addNewTemplate(name: $name)\n  }\n"]);return Ue=function(){return e},e}function Ge(){var e=Object(o.a)(["\n  {\n    templates {\n      isEnabled\n      name\n    }\n  }\n"]);return Ge=function(){return e},e}var qe=Object(x.a)((function(e){return{margin:{margin:e.spacing(1)},table:{minWidth:250},title:{flexGrow:1},menuButton:{marginRight:e.spacing(2)}}})),Ke=Object(m.a)(Ge()),Me=Object(m.a)(Ue()),He=Object(m.a)(ze()),Je=Object(m.a)(Ae());function Qe(e){var a=qe();return r.a.createElement(B.a,{component:L.a},r.a.createElement(T.a,{className:a.table,"aria-label":"simple table",size:"small"},r.a.createElement(W.a,null,r.a.createElement(F.a,null,r.a.createElement(D.a,null,"\u9078\u64c7"),r.a.createElement(D.a,{align:"left"},"\u904a\u6232\u6a21\u5f0f"),r.a.createElement(D.a,{align:"right"},r.a.createElement("div",{style:{marginRight:10}},"\u7de8\u8f2f")),r.a.createElement(D.a,{align:"right"},r.a.createElement("div",{style:{marginRight:10}},"\u522a\u9664")))),r.a.createElement(R.a,null,e.data.map((function(a){return r.a.createElement(F.a,{key:a.name},r.a.createElement(D.a,null,r.a.createElement(V.a,{onChange:function(n){n.target.checked&&e.onSelect(a.name)},color:"primary",inputProps:{"aria-label":"secondary checkbox"},checked:a.isEnabled})),r.a.createElement(D.a,{align:"left"},a.name),r.a.createElement(D.a,{align:"right"},r.a.createElement(O.a,{"aria-label":"delete",onClick:function(){console.log(a.name),e.onEdit(a.name)}},r.a.createElement(ie.a,null))),r.a.createElement(D.a,{align:"right"},r.a.createElement(O.a,{"aria-label":"delete",onClick:function(){e.onDelete(a.name)},disabled:a.isEnabled},r.a.createElement(re.a,null))))})))))}function Ye(e){var a,n=qe(),t=Object(f.a)(Me),l=Object(c.a)(t,1)[0],i=Object(f.a)(He),o=Object(c.a)(i,1)[0],u=r.a.useState(""),m=Object(c.a)(u,2),d=m[0],s=m[1],b=r.a.useState(!1),g=Object(c.a)(b,2),p=g[0],E=(g[1],Object(Z.a)(Ke,{})),v=E.loading,h=(E.error,E.data),O=E.stopPolling,j=(E.startPolling,E.called,Object(f.a)(Je,{onCompleted:function(){}})),y=Object(c.a)(j,2),x=y[0],k=y[1];return r.a.useEffect((function(){return O}),[]),v||v||k.loading||p?r.a.createElement("div",null,"Loading"):r.a.createElement("div",null,r.a.createElement("div",{style:{display:"flex",justifyContent:"center"}},r.a.createElement(N.a,{id:"standard-basic",label:"\u6a21\u5f0f\u540d\u7a31",variant:"outlined",className:n.margin,margin:"dense",value:d,onChange:function(e){return s(e.target.value)}}),r.a.createElement("div",{style:{marginTop:5}},r.a.createElement(ee.a,(a={size:"medium",color:"secondary","aria-label":"add"},Object(X.a)(a,"size","small"),Object(X.a)(a,"onClick",(function(){l({variables:{name:d}})})),a),r.a.createElement(ne.a,null)))),r.a.createElement(C.a,{maxWidth:"sm"},r.a.createElement(Qe,{data:h.templates,onEdit:function(a){e.setEditName(a)},onSelect:function(e){x({variables:{name:e}}),O()},onDelete:function(e){o({variables:{name:e}})}})))}function _e(e){qe();var a=r.a.useState(""),n=Object(c.a)(a,2),t=(n[0],n[1],r.a.useState("")),l=Object(c.a)(t,2),i=l[0],o=l[1],m=Object(f.a)(Me),d=(Object(c.a)(m,1)[0],Object(f.a)(He)),s=(Object(c.a)(d,1)[0],r.a.useState(!1)),b=Object(c.a)(s,2);b[0],b[1];return console.log(),i?r.a.createElement("div",null,r.a.createElement(S.a,{display:"flex"},r.a.createElement(u.a,{variant:"contained",color:"secondary",onClick:function(){o("")}},"\u9000\u51fa")),r.a.createElement(Ve,{name:i,data:e.data})):r.a.createElement(Ye,{setEditName:function(e){o(e)}})}function Xe(){var e=Object(o.a)(["\n  {\n    enabledTemplate {\n      name\n      description\n      roles {\n        name\n        id\n        number\n      }\n    }\n  }\n"]);return Xe=function(){return e},e}var Ze=Object(m.a)(Xe());function ea(e){var a=Object(Z.a)(Ze,{fetchPolicy:"network-only"}),n=a.loading,t=(a.error,a.data);if(n)return r.a.createElement("div",null,"Loading");var l=t.enabledTemplate,i=l.name,c=l.description,o=l.roles;return console.log(t.enabledTemplate),r.a.createElement("div",null,r.a.createElement(E.a,{variant:"h2",gutterBottom:!0},i),r.a.createElement(N.a,{id:"outlined-multiline-static",multiline:!0,rows:6,fullWidth:!0,value:c||"",variant:"outlined",label:"\u898f\u5247",disabled:!0}),r.a.createElement(J,{data:o}))}var aa=n(115),na=n(403),ta=n(384),ra=n(397),la=n(381),ia=n(383),ca=n(382);function oa(){var e=Object(o.a)(["\n  mutation DarkStart($targets: [Int]) {\n    voteStart(targets: $targets)\n  }\n"]);return oa=function(){return e},e}function ua(){var e=Object(o.a)(["\n  mutation DarkStart {\n    darkStart\n  }\n"]);return ua=function(){return e},e}function ma(){var e=Object(o.a)(["\n  mutation RemoveAllPlayer {\n    removeAllPlayer\n  }\n"]);return ma=function(){return e},e}function da(){var e=Object(o.a)(["\n  mutation GenerateTemplatePlayer {\n    generateTemplatePlayer\n  }\n"]);return da=function(){return e},e}function sa(){var e=Object(o.a)(["\n  mutation GenerateTemplateRole {\n    generateTemplateRole\n  }\n"]);return sa=function(){return e},e}function ba(){var e=Object(o.a)(["\n  mutation UpdatePlayerName($id: Int!, $name: String!) {\n    updatePlayerName(id: $id, name: $name)\n  }\n"]);return ba=function(){return e},e}function fa(){var e=Object(o.a)(["\n  {\n    enabledTemplate {\n      name\n      description\n      roles {\n        name\n        id\n        number\n      }\n    }\n    players {\n      id\n      name\n      roleName\n    }\n  }\n"]);return fa=function(){return e},e}function ga(){var e=Object(o.a)(["\n  {\n\n\n    enabledTemplate {\n      name\n      description\n      roles {\n        name\n        id\n        number\n      }\n    }\n    players {\n      id\n      name\n      roleName\n      isEmpty\n      isDie\n      isVoteFinish\n      votedNumber\n    }\n    gameInfo(id: 0) {\n      isVoteFinish\n      chiefId\n    }\n  }\n"]);return ga=function(){return e},e}var pa=Object(m.a)(ga()),Ea=(Object(m.a)(fa()),Object(m.a)(ba())),va=Object(m.a)(sa()),ha=Object(m.a)(da()),Oa=Object(m.a)(ma()),ja=(Object(m.a)(ua()),Object(m.a)(oa())),ya=Object(x.a)((function(e){return{margin:{margin:e.spacing(1)},table:{minWidth:250},title:{flexGrow:1},menuButton:{marginRight:e.spacing(2)}}}));function xa(e){var a=e.children,n=e.value,t=e.index,l=Object(P.a)(e,["children","value","index"]);return r.a.createElement("div",Object.assign({role:"tabpanel",hidden:n!==t,id:"full-width-tabpanel-".concat(t),"aria-labelledby":"full-width-tab-".concat(t)},l),n===t&&r.a.createElement(S.a,{p:3},a))}var Ca=function(e){var a={};e.players.forEach((function(e){var n=e.roleName,t=e.name,r=e.id;a[n]?a[n].push({name:t||"",id:r}):a[n]=[{name:t||"",id:r}]})),console.log(a);var n=[];return e.enabledTemplate.roles.forEach((function(e){var t=e.name;n.push(Object(I.a)({},e,{players:a[t]}))})),console.log(n),n};function ka(e){return r.a.createElement(Q,{data:e.data})}function Sa(e){var a=r.a.useState([]),n=Object(c.a)(a,2),t=n[0],l=n[1],i=Object(f.a)(ja,{onCompleted:function(){e.onClose()}}),o=Object(c.a)(i,1)[0];return r.a.createElement(r.a.Fragment,null,r.a.createElement(la.a,null,r.a.createElement(ca.a,{id:"alert-dialog-slide-description"},"".concat(e.hasChief?"\u8acb\u9078\u64c7\u653e\u9010\u7684\u76ee\u6a19":"\u8acb\u9078\u64c7\u8b66\u9577\u5019\u9078\u4eba",", \u76ee\u6a19\u5fc5\u9808\u591a\u65bc\u4e00\u4eba, \u6295\u7968\u4eba\u6578\u4e5f\u5fc5\u9808\u591a\u65bc\u4e00\u4eba")),e.players.filter((function(e){return!e.isDie&&0!==e.id})).map((function(a){return r.a.createElement("div",{key:a.id},r.a.createElement(ra.a,{checked:t.includes(a.id),name:"radio-button-demo",inputProps:{"aria-label":"B"},onClick:function(){t.includes(a.id)||t.length+1===e.players.filter((function(e){return!e.isDie&&0!==e.id})).length||l([].concat(Object(w.a)(t),[a.id]))}})," ".concat(a.id," : ").concat(a.name||""))})),r.a.createElement(ra.a,{checked:0===t.length,name:"radio-button-demo",inputProps:{"aria-label":"B"},onClick:function(){l([])}}),"\u6240\u6709\u4eba"),r.a.createElement(ia.a,null,(0===t.length||t.length>1)&&r.a.createElement(u.a,{onClick:function(){o({variables:{targets:t}})},color:"primary"},"\u78ba\u8a8d")))}function $a(e){ya();var a=Object(f.a)(va),n=Object(c.a)(a,1)[0],t=Object(f.a)(ha),l=Object(c.a)(t,1)[0],i=Object(f.a)(Oa),o=Object(c.a)(i,1)[0],m=Object(f.a)(ja),d=(Object(c.a)(m,1)[0],r.a.useState(!1)),s=Object(c.a)(d,2),b=s[0],g=s[1],p=Object(aa.a)(e.name,500),E=Object(c.a)(p,2),v=E[0],h=E[1],O=r.a.useState(e.name||""),j=Object(c.a)(O,2),y=j[0],x=j[1],C=Object(f.a)(Ea),k=Object(c.a)(C,2),$=k[0],w=k[1].called;r.a.useEffect((function(){v&&(v!==e.name||w)&&$({variables:{id:0,name:v}})}),[v]);var I=-1!==e.chiefId;return e.isPlayerMode?r.a.createElement(r.a.Fragment,null,r.a.createElement(na.a,{"aria-labelledby":"simple-dialog-title",open:b,onClose:function(){g(!1)}},r.a.createElement(ta.a,{id:"form-dialog-title"},I?"\u653e\u9010\u958b\u59cb":"\u7af6\u9078\u8b66\u9577"),r.a.createElement(Sa,{players:e.players,onClose:function(){g(!1)},hasChief:I})),r.a.createElement(S.a,{display:"flex"},r.a.createElement(u.a,{variant:"contained",color:"primary",onClick:function(){n()}},"\u7522\u751f\u89d2\u8272"),r.a.createElement(u.a,{variant:"contained",color:"secondary",onClick:function(){o()}},"\u522a\u9664\u73a9\u5bb6"),r.a.createElement(u.a,{variant:"contained",color:"secondary",onClick:function(){g(!0)}},I?"\u653e\u9010":"\u8b66\u9577")),r.a.createElement(S.a,{display:"flex"},r.a.createElement(N.a,{id:"standard-basic",label:"\u59d3\u540d",variant:"outlined",margin:"dense",value:y,onChange:function(e){h(e.target.value),x(e.target.value)}})),r.a.createElement(K,{data:e.players,chiefId:e.chiefId})):r.a.createElement("div",{style:{}},r.a.createElement(S.a,{display:"flex"},r.a.createElement(u.a,{variant:"contained",color:"primary",onClick:function(){l()}},"\u52a0\u5165\u73a9\u5bb6")),r.a.createElement(ea,null))}function wa(e){var a=Object($.f)(),n=r.a.useState(0),l=Object(c.a)(n,2),i=l[0],o=l[1],u=Object(g.a)(pa,{fetchPolicy:"network-only"}),m=Object(c.a)(u,2),d=m[0],s=m[1],b=s.loading,f=s.data,p=(s.stopPolling,s.startPolling,s.error),E=s.called,v=!0;if(Object(t.useEffect)((function(){v&&d();var e=setInterval((function(){v&&d()}),500);return function(){clearInterval(e),v=!1}}),[]),r.a.useEffect((function(){p&&!b&&p.graphQLErrors.forEach((function(e){"UNAUTHENTICATED"===e.extensions.code&&(console.log("no access!!!"),a.push("/"))}))}),[p,b]),!E||!f)return r.a.createElement("div",null,"Loading");var h=e.id,O=e.pass,j=e.name,y=f.players.length>1;return r.a.createElement(L.a,{elevation:3},r.a.createElement(Y.a,{value:i,indicatorColor:"primary",textColor:"primary",onChange:function(e,a){o(a)},"aria-label":"disabled tabs example",variant:"fullWidth"},r.a.createElement(_.a,{label:"\u904a\u6232"}),r.a.createElement(_.a,{label:y?"\u9ed1\u591c\u8996\u91ce":"\u6a21\u5f0f\u9078\u64c7"}),y&&r.a.createElement(_.a,{label:"\u6a21\u5f0f"})),r.a.createElement(xa,{value:i,index:0},r.a.createElement($a,{isPlayerMode:y,id:h,pass:O,name:j,players:f.players,chiefId:f.gameInfo.chiefId})),r.a.createElement(xa,{value:i,index:1},y?r.a.createElement(ka,{data:Ca(f)}):r.a.createElement(_e,{data:Ca(f)})),y&&r.a.createElement(xa,{value:i,index:2},r.a.createElement(ea,null)))}var Ia=n(386),Pa=n(387);function Na(){var e=Object(o.a)(["\n  mutation DarkAction($targetId: Int!, $id: Int!) {\n    exeDarkAction(targetId: $targetId, id: $id)\n  }\n"]);return Na=function(){return e},e}function Ta(){var e=Object(o.a)(["\n  mutation UpdatePlayerName($id: Int!, $name: String!) {\n    updatePlayerName(id: $id, name: $name)\n  }\n"]);return Ta=function(){return e},e}function Ra(){var e=Object(o.a)(["\n  mutation SubmitVote($target: Int!) {\n    submitVote(target: $target)\n  }\n"]);return Ra=function(){return e},e}function Da(){var e=Object(o.a)(["\n  query GetPlayer($id: Int!, $pass: String!) {\n    player(id: $id, pass: $pass) {\n      id\n      name\n      roleName\n    }\n    players(id: $id) {\n      id\n      name\n      isEmpty\n      revealedRole\n      isDie\n      vote\n      chiefVote\n      isValidCandidate\n      isVoteFinish\n    }\n    wolfKillList(id: $id) {\n      id\n      isKill\n    }\n    gameInfo(id: $id) {\n      isVoteFinish\n      chiefId\n    }\n    darkInfo(id: $id) {\n      isStart\n      remainTime\n      actRoleType\n      darkDay\n      targetList {\n        id\n        isKill\n      }\n    }\n  }\n"]);return Da=function(){return e},e}var Ba=Object(x.a)((function(e){return{margin:{},table:{minWidth:450},title:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},submit:{margin:e.spacing(3,0,2)},container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)}}})),Wa=Object(m.a)(Da()),Fa=Object(m.a)(Ra()),La=Object(m.a)(Ta());Object(m.a)(Na());function Va(e){var a=e.children,n=e.value,t=e.index,l=Object(P.a)(e,["children","value","index"]);return r.a.createElement("div",Object.assign({role:"tabpanel",hidden:n!==t,id:"full-width-tabpanel-".concat(t),"aria-labelledby":"full-width-tab-".concat(t)},l),n===t&&r.a.createElement(S.a,{p:3},a))}function Aa(e){var a=Ba();return r.a.createElement(B.a,{component:L.a},r.a.createElement(T.a,{className:a.table,"aria-label":"simple table",size:"small"},r.a.createElement(W.a,null,r.a.createElement(F.a,null,r.a.createElement(D.a,null,"ID"),r.a.createElement(D.a,{align:"center"},"\u73a9\u5bb6"),r.a.createElement(D.a,{align:"center"},"\u8b66\u9577"),r.a.createElement(D.a,{align:"center"},"\u653e\u9010"),r.a.createElement(D.a,{align:"right"},"\u72c0\u614b"))),r.a.createElement(R.a,null,e.data.map((function(a){return r.a.createElement(F.a,{key:a.id},r.a.createElement(D.a,{component:"th",scope:"row"},0===a.id?"\u267e\ufe0f":a.isDie?r.a.createElement("span",{"aria-label":"paw",style:{fontSize:30}},"\ud83d\udc3e"):a.id,a.id===e.chiefId&&0!==a.id&&r.a.createElement("span",{"aria-label":"paw",style:{fontSize:30}},"\ud83c\udf1f")),r.a.createElement(D.a,{align:"center"},a.name),r.a.createElement(D.a,{align:"right"},a.chiefVote.toString()),r.a.createElement(D.a,{align:"right"},a.vote.toString()),r.a.createElement(D.a,{align:"right"},r.a.createElement("span",{style:{color:a.isEmpty?"gray":a.isVoteFinish?"lightgreen":"orange",transition:"all .3s ease",fontSize:"24px",marginRight:"10px"}},"\u25cf")))})))))}new Audio("/witch_kill.mp3"),new Audio("/witch_save.mp3"),new Audio("/wolf.mp3"),new Audio("/prophet.mp3"),new Audio("/hunter.mp3"),new Audio("/guard.mp3");function za(e){var a=r.a.useState(-1),n=Object(c.a)(a,2),t=n[0],l=n[1],i=Object(f.a)(Fa),o=Object(c.a)(i,2),m=o[0];o[1].called;return r.a.createElement(r.a.Fragment,null,r.a.createElement(la.a,null,e.players.filter((function(e){return e.isValidCandidate})).map((function(e){return r.a.createElement("div",{key:e.id},r.a.createElement(ra.a,{checked:e.id===t,name:"radio-button-demo",inputProps:{"aria-label":"B"},onClick:function(){l(e.id)}})," ".concat(e.id," : ").concat(e.name||""))})),r.a.createElement(ra.a,{checked:-1===t,name:"radio-button-demo",inputProps:{"aria-label":"B"},onClick:function(){l(-1)}}),"\u68c4\u6b0a"),r.a.createElement(ia.a,null,r.a.createElement(u.a,{onClick:function(){m({variables:{target:t}})},color:"primary"},"\u78ba\u8a8d")))}function Ua(e){var a=Ba(),n=Object($.f)(),l=Object(g.a)(Wa,{fetchPolicy:"network-only"}),i=Object(c.a)(l,2),o=i[0],u=i[1],m=u.loading,d=u.error,s=u.data,b=u.called,p=r.a.useState(!0),v=Object(c.a)(p,2),h=(v[0],v[1],Object(aa.a)(e.name,500)),O=Object(c.a)(h,2),j=O[0],y=O[1],x=r.a.useState(e.name),C=Object(c.a)(x,2),k=C[0],w=C[1],I=Object(f.a)(La),P=Object(c.a)(I,2),T=P[0],R=P[1].called,D=!0;if(Object(t.useEffect)((function(){D&&o({variables:{id:e.id,pass:e.pass}});var a=setInterval((function(){D&&o({variables:{id:e.id,pass:e.pass}})}),500);return function(){clearInterval(a),D=!1}}),[]),r.a.useEffect((function(){j&&(j!==e.name||R)&&T({variables:{id:e.id,name:j}}),d&&!m&&n.push("/")}),[j,d,m]),!b||!s)return r.a.createElement("div",null,"Loading");var B=-1!==s.gameInfo.chiefId,W=s.player,F=W.id,L=(W.name,W.roleName);return r.a.createElement(r.a.Fragment,null,r.a.createElement(na.a,{"aria-labelledby":"simple-dialog-title",open:!s.gameInfo.isVoteFinish},r.a.createElement(ta.a,{id:"form-dialog-title"},B?"\u653e\u9010\u73a9\u5bb6":"\u9078\u64c7\u8b66\u9577"),r.a.createElement(za,{players:s.players,id:F})),r.a.createElement(S.a,{display:"flex"},r.a.createElement(N.a,{id:"standard-basic",label:"\u59d3\u540d",variant:"outlined",className:a.margin,margin:"dense",value:k,onChange:function(e){y(e.target.value),w(e.target.value)}})),r.a.createElement(Ia.a,{className:a.root},r.a.createElement(Pa.a,null,r.a.createElement(E.a,{variant:"h1",component:"h1"},L))),r.a.createElement(Aa,{data:s.players,chiefId:s.gameInfo.chiefId}))}function Ga(e){var a=e.id,n=e.pass,t=e.name,l=r.a.useState(0),i=Object(c.a)(l,2),o=i[0],u=i[1];return r.a.createElement(L.a,{elevation:3},r.a.createElement(Y.a,{value:o,indicatorColor:"primary",textColor:"primary",onChange:function(e,a){u(a)},"aria-label":"disabled tabs example",variant:"fullWidth"},r.a.createElement(_.a,{label:"\u73a9\u5bb6"}),r.a.createElement(_.a,{label:"\u6a21\u5f0f"})),r.a.createElement(Va,{value:o,index:0},r.a.createElement(Ua,{id:a,pass:n,name:t})),r.a.createElement(Va,{value:o,index:1},r.a.createElement(ea,null)))}var qa=n(143);function Ka(){var e=Object(o.a)(["\n  mutation UpdatePlayerPass($id: Int!, $pass: String!) {\n    updatePlayerPass(id: $id, pass: $pass) {\n      isValid\n      id\n    }\n  }\n"]);return Ka=function(){return e},e}function Ma(){var e=Object(o.a)(["\n  {\n    players {\n      id\n      name\n      isEmpty\n    }\n  }\n"]);return Ma=function(){return e},e}var Ha=Object(x.a)((function(e){return{margin:{},table:{minWidth:450},title:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},submit:{margin:e.spacing(3,0,2)},container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)}}})),Ja=Object(m.a)(Ma()),Qa=Object(m.a)(Ka());function Ya(){return r.a.createElement(E.a,{variant:"body2",color:"textSecondary",align:"center"},"Copyright \xa9 ",(new Date).getFullYear())}function _a(){var e=Object($.f)(),a=Ha(),n=r.a.useState(-1),t=Object(c.a)(n,2),l=t[0],i=t[1],o=r.a.useState(""),m=Object(c.a)(o,2),d=m[0],s=m[1],b=r.a.useState(!1),g=Object(c.a)(b,2),p=(g[0],g[1],Object(Z.a)(Ja,{})),E=p.loading,v=(p.error,p.data),h=p.stopPolling,O=p.startPolling,j=Object(f.a)(Qa,{onCompleted:function(a){a.updatePlayerPass.isValid&&e.push("/game")}}),y=Object(c.a)(j,2),x=y[0],w=y[1];w.loading,w.data;return r.a.useEffect((function(){return O(500),function(){h()}}),[]),E?r.a.createElement("div",null,"Loading"):r.a.createElement(C.a,{component:"main",maxWidth:"xs"},r.a.createElement(k.a,null),r.a.createElement("div",{style:{marginTop:"20%"}},r.a.createElement(qa.a,{round:!0,src:"wolf-login.png"}),r.a.createElement(ce.a,{fullWidth:!0,id:"combo-box-demo",className:a.margin,options:v.players,getOptionLabel:function(e){return"\u73a9\u5bb6 ".concat(e.id)},renderOption:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{style:{color:e.isEmpty?"gray":"lightgreen",transition:"all .3s ease",fontSize:"24px",marginRight:"10px"}},"\u25cf")," \u73a9\u5bb6 ".concat(e.id))},onChange:function(e,a){i(a.id)},renderInput:function(e){return r.a.createElement(N.a,Object.assign({},e,{label:"\u73a9\u5bb6",variant:"outlined",margin:"dense"}))}}),r.a.createElement(N.a,{fullWidth:!0,id:"standard-basic",label:"\u5bc6\u78bc",variant:"outlined",className:a.margin,margin:"dense",onChange:function(e){return s(e.target.value)},value:d}),r.a.createElement(u.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:a.submit,onClick:function(){x({variables:{id:l,pass:d}})}},"\u767b\u5165")),r.a.createElement(S.a,{mt:8},r.a.createElement(Ya,null)))}var Xa=n(95);function Za(){var e=Object(o.a)(["\n  mutation UpdatePlayerPass($id: Int!, $pass: String!) {\n    updatePlayerPass(id: $id, pass: $pass) {\n      isValid\n      name\n    }\n  }\n"]);return Za=function(){return e},e}function en(){var e=Object(o.a)(["\n  mutation Logoff {\n    logoff\n  }\n"]);return en=function(){return e},e}function an(){var e=Object(o.a)(["\n  {\n    players {\n      id\n      name\n      isEmpty\n    }\n    login {\n      id\n      isValid\n    }\n  }\n"]);return an=function(){return e},e}var nn=new d.a({cache:new s.a,link:new b.a({uri:"/graphql"})}),tn=new d.a({cache:new s.a,link:new b.a({uri:"/auth"})}),rn=Object(x.a)((function(e){return{margin:{},table:{minWidth:450},title:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},submit:{margin:e.spacing(3,0,2)},container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)}}})),ln=Object(m.a)(an()),cn=Object(m.a)(en());Object(m.a)(Za());function on(){return r.a.createElement(E.a,{variant:"body2",color:"textSecondary",align:"center"},"Copyright \xa9 ",(new Date).getFullYear())}function un(){var e=Object($.f)(),a=Object(f.a)(cn,{onCompleted:function(){e.push("/")}}),n=Object(c.a)(a,1)[0];return r.a.createElement(u.a,{variant:"contained",color:"secondary",onClick:function(){n()}},"\u9000\u51fa")}function mn(){var e=Object($.f)(),a=Object(g.a)(ln,{fetchPolicy:"network-only"}),n=Object(c.a)(a,2),l=n[0],i=n[1],o=i.loading,u=i.error,m=i.data,d=rn(),s=!0;if(Object(t.useEffect)((function(){return s&&l(),function(){s=!1}}),[]),r.a.useEffect((function(){u&&u.graphQLErrors.forEach((function(a){"UNAUTHENTICATED"===a.extensions.code&&e.push("/")}))}),[u]),o||!m)return r.a.createElement("div",null,"Loading");console.log(m,o);var b=m.login.id;return r.a.createElement(r.a.Fragment,null,r.a.createElement(k.a,null),r.a.createElement(C.a,{maxWidth:"sm"},r.a.createElement(v.a,{position:"absolute"},r.a.createElement(h.a,null,r.a.createElement(O.a,{edge:"start",className:d.menuButton,color:"inherit","aria-label":"menu"},r.a.createElement(y.a,null)),r.a.createElement(E.a,{variant:"h6",className:d.title},"\u5c0f\u72fc\u72fc"),r.a.createElement(un,null))),r.a.createElement("div",{style:{marginTop:100,width:600}},0===b?r.a.createElement(wa,{id:b,pass:"",name:""}):r.a.createElement(Ga,{id:b,pass:"",name:""})),r.a.createElement(S.a,{pt:4},r.a.createElement(on,null))))}var dn=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(Xa.a,null,r.a.createElement($.c,null,r.a.createElement($.a,{exact:!0,path:"/"},r.a.createElement(p.a,{client:tn},r.a.createElement(_a,null))),r.a.createElement($.a,{exact:!0,path:"/game"},r.a.createElement(p.a,{client:nn},r.a.createElement(mn,null))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(dn,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[286,1,2]]]);
//# sourceMappingURL=main.17cd6489.chunk.js.map